import sys
from icecream import ic
from collections import deque
from dataclasses import dataclass
from typing import Tuple
import re
from tqdm import tqdm
from math import gcd
from functools import lru_cache


ans = 0
skips = 0


def p2():
    res = 0

    for line in tqdm(arr):
        # records, b = tuple(line.split())
        # requirements = tuple(map(int, b.split(",")))
        records, b = tuple(line.split())
        records = "?".join([records]*5)
        requirements = tuple(map(int, b.split(",")))*5

        # ic(records, requirements)

        @lru_cache(maxsize=None)
        def generate_possibilities3(rid=0, req_id=0, block_len=0):
            res = 0

            # Reached the end of the records
            if rid>=len(records):
                assert rid==len(records)
                # could be a matching sequence
                if req_id==len(requirements) and block_len==0 or req_id==len(requirements)-1 and requirements[req_id]==block_len:
                    # ic(rid, req_id, block_len, a)
                    return 1
                else:
                    return 0

            # continue the block
            if records[rid] in ["#", "?"]:
                # res += generate_possibilities3(rid+1, req_id, block_len+1, a+"#")
                res += generate_possibilities3(rid+1, req_id, block_len+1)

            # Discontinue the block and start a new one
            if records[rid] in [".", "?"]:
                # could be a matching sequence
                if req_id<len(requirements) and requirements[req_id]==block_len:
                    # res += generate_possibilities3(rid+1, req_id+1, 0, a+".")
                    res += generate_possibilities3(rid+1, req_id+1, 0)
                # otherwise, we do over if no hashtag was set yet
                elif block_len==0:
                    res += generate_possibilities3(rid+1, req_id, 0)

            return res

        res += generate_possibilities3()

    ic(res)

@lru_cache
def generate_possibilities2(records, requirements, i=0):
    # ic(["".join(record) for record in records], requirements, i)
    if i>=len(records):
        assert all(len(record)==record.count("#") for record in records)
        if tuple(map(lambda x: len(x), records))==requirements:
            assert sum(map(lambda x: x.count("#"), records)) == sum(requirements)
            global ans
            ans += 1
        return

    if records[i].count("?")==0:
        assert records[i].count("#") == len(records[i])
        try:
            if i>=len(requirements) or records[i].count("#")!=requirements[i]:
                # global skips
                # skips += 1
                # print(skips, end="\r")
                return
        except:
            ic(["".join(record) for record in records], requirements, i)
            raise
        generate_possibilities2(records, requirements, i+1)
        return

    j = records[i].index("?")

    copy_records = [list(record) for record in records]
    copy_records[i][j] = "#"
    generate_possibilities2(tuple(map(lambda x: tuple(x), copy_records)), requirements, i)

    copy_records = [tuple(record) for record in records]
    a = copy_records[i][:j]
    b = copy_records[i][j+1:]
    del copy_records[i]
    k = 0
    if len(a)!=0:
        copy_records.insert(i, a)
        k += 1
    if len(b)!=0:
        copy_records.insert(i+k, b)

    # ic(["".join(record) for record in copy_records], requirements, i)
    generate_possibilities2(tuple(copy_records), requirements, i)


def generate_possibilities2(records, requirements, i, j, cur):
    pass


def p2_bad():
    global ans
    ans = 0
    for line in tqdm(arr):
        # records, b = tuple(line.split())
        # records = tuple(map(lambda x: tuple(x), filter(lambda x: x!="", records.split("."))))
        # requirements = tuple(map(int, b.split(",")))
        records, b = tuple(line.split())
        records = tuple(map(lambda x: tuple(x), filter(lambda x: x!="", "?".join([records]*5).split("."))))
        requirements = tuple(map(int, b.split(",")))*5

        generate_possibilities2(records, requirements)

    ic(ans)


def generate_possibilities(records, i=0):
    if i>=len(records):
        yield records
        return

    if records[i] != "?":
        yield from generate_possibilities(records, i+1)
        return

    for c in ".#":
        a = records.copy()
        a[i] = c
        yield from generate_possibilities(a, i+1)


def p1():
    ans = 0
    for line in tqdm(arr):
        records, b = tuple(line.split())
        records = list(records)
        requirements = tuple(map(int, b.split(",")))

        for possibility in generate_possibilities(records):
            hashes = tuple(map(lambda x: x.count("#"), filter(lambda x: x!="", "".join(possibility).split("."))))
            ans += requirements == hashes
            if requirements == hashes:
                ic(possibility)

    ic(ans)


def main():
    assert len(sys.argv) == 3
    sys.setrecursionlimit(25_000)
    TEST_INPUT_STATE = sys.argv[2]
    TEST_STATE = sys.argv[1]

    if TEST_INPUT_STATE == "test":
        inps = tests
    if TEST_INPUT_STATE == "prod":
        inps = prod

    global arr
    for inp in inps:
        arr = [s.strip() for s in inp.split("\n")[1:-1]]
        if TEST_STATE == "p1":
            p1()
        elif TEST_STATE == "p2":
            p2()


tests = [
# """
# ????.######..#####. 1,6,5
# """,
"""
???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1
"""
]


prod = [
"""
#.?#.#???????...??## 1,2,2,1,1,4
???#???.?#?????? 1,2,2,3,2
???????#??.???#? 2,2,4,3
.???????#?? 4,1
?????#????. 1,2,1
#.?#???#???.?#. 1,3,1,1,2
???#?.#.?#??????# 1,2,1,9
.???#????? 4,1
#????#??..????? 1,2
??.#?.???????#??? 2,1,6,3
???.???????.#.#?#?. 1,3,1,1,1,1
???##?????????????## 12,2
???#?????.?#??????.. 9,1,4
?????#?..???????##?? 4,1,1,6
.?#.?.??????.????#. 2,2,5
?##?##.#?##?#????. 5,4,2,1
???..??..????? 2,1,4
?????#?.?##.??##?. 5,3,4
.???.#.#??????.??? 3,1,1,1,1,1
?.???.?#???#??#?# 1,3,1,1,6
.?.??..???#???#????# 1,1,12
..?.?..??? 1,3
???.????????? 3,1,1
.?????.??##??? 3,2
.???????#.### 2,2,1,3
##???.??????#?#?#??? 3,1,1,10
.?##??##??#??? 3,3,1
.????.????????????? 2,1,3,1,1,1
???#??#??.#?? 8,1
???.????.?? 2,1,2
??#?#?.????? 4,1
???????#???#?#?#? 4,9
#.???????. 1,1,3
?#??????.? 1,1,1
?#???##?.???..???? 8,2,1
????????#???.# 9,1,1
???.???#???#?????? 1,1,1,3,4,1
?????##?.??#? 1,5,3
#??##.?.????#???? 1,2,1,6,1
?????#????#???? 1,1,7
????????..??????? 1,2,1,3,1
?##?...???#.?? 4,4
?????#.?.??? 2,3
????.?????#???### 1,1,5,3
#.???#?#?????# 1,3,1,5
.????#?.?????#????? 4,5
.??.???.#?#?#?#.? 2,1,7
.??#?????.?. 5,1
??#??##?.???? 4,2,2
?.?.###?.?#?????##? 1,3,2,5
?#??????#?.??..?# 2,5,2
.????????##?.? 2,4
????##??#???????. 12,2
?.#??.??????#??#?# 1,1,1,9
?#?#??#??#?.???????# 8,1,3,1,1
.?????????.??#? 2,1
??##??.??.? 1,3,1
??.????##???#????# 1,1,7,2,1
????.#???#??##????.? 2,1,9,1
?.??###?.?.??? 4,1
??????#.??????? 6,3,1
??.?????##??. 1,1,6
.#????#??? 1,1,1
??#??.??.?. 4,2,1
?.????????.?.... 1,1
#??..?.#??.?? 3,3
..?#???#?#??#?..#??? 2,8,1,1
???#???.??? 4,1,1
????#?..?.?????? 3,3
??????#????#?.?.?# 12,1,1
#??????????#..? 1,3,1,1,1
???#??#.?#????#? 4,1,2,2
#.?#??#?#???#?.# 1,1,6,1,1
??????.??????. 1,1,2,2
???#???#?. 1,1,1
..??.????#?##??#?? 1,1,9
???.????#?? 1,5
.??.?.???? 1,1,1
??.#????????????#. 1,8,1,2
?#?????????????? 5,1,5
..??.??.#?#?? 1,1,1,3
?????#?????...???? 5,1,1,1,1
.???.??#??# 3,5
???#.????#??????# 3,2,1,1
??????####?.?? 1,8,1
..???#???..??? 4,1,2
????##?#?.#?.?? 2,5,2,1
??##?#???????.??.. 8,1,1
??????????#? 2,1,1
?.?#???#????.???#?? 1,3,1,3,1,3
???????#?? 1,3
???.?#...##???# 1,1,2,1,1
#?.#?#?????. 1,1,1,2
.##.????###?.?.? 2,7,1,1
?#????#???????#???. 9,2
?.#???#??##????? 1,2,6,2
.#?#???.?#??????# 3,1,1,2,3
?#?#??.?..???#?. 4,1,4
?###..?##???#??#. 4,3,1,1
.#??.#????..?..?? 2,1,2,1,2
?..??.??????.?..? 2,3
.?#.??##???????.?? 1,9
???..???????###???. 1,1,8,1
???##??????.? 3,3
???????#??? 1,1,3
??.??????##.??. 1,1,6,2
.##????????????????. 2,5,1,2,1
?#??#????? 1,4,1
#??????.???#???? 4,1,2,1
.##??.??#???#?????? 3,11
.?.??..???.#??? 1,2
...??..??.#????? 2,1
.??#?#?#?#???#?? 9,3
.?#????..##?? 3,3
##??##?????#???#??? 13,2,1
????????????#??# 1,1,6,1,1
?#?##???#??? 1,6
##????#.?#??.#?????? 5,1,2,3,1
??#????#??? 1,4
?.?.?.????##?#?##?? 1,1,1,7,2,1
?????????.??.??. 2,2,1,2,1
??????.????? 4,5
??#?.???#?#??.???? 2,1,6,2
.#.??#...#?.??? 1,1,2
..???.??.?. 1,1
#????.????? 1,1,4
?#.???#??##??? 1,1,3,1
???##???##??#?##.#?? 15,1
?????.#.????? 1,1
???#?#?###??????? 1,8,1,1
?????#????????.#?# 2,7,1,1,1
.????????.#?.#. 3,3,1,1
???##?#?.. 1,6
????#????????#?.??. 6,3
.##?#?.????????? 4,1,2
?#?...????#? 3,4
???.????#? 1,3
???.#??????#??.#??. 3,8,1,1,1
.#???##???? 3,3
??????#?????. 6,1
???.?.?????#? 3,3,1
??##???#????.?#?#?? 4,4,2,1,1
???#??.??.#??#? 3,2,2,1
##?##???????????.? 7,2,1,1,1
.?.??.#????? 1,1,3
?.??????.???#????# 1,1,4,1,2
??#???#?.#?#?##.? 4,2,6,1
..??#..??###?? 2,5
?#????????..?#???#? 3,3,1,3,2
?.???????? 2,2
#?????#?###??? 1,9
??.???##?.???????#?? 1,1,2,10
?#?#.????#?.?#??? 4,5,5
???.????????..? 1,5
???#?????.?#.???##?. 2,6,1,5
.????????###??????? 2,1,6,1
??#?.?#?.???? 3,2,1
.????#????.# 1,1,5,1
??????##?.?..??? 2,3
.?#??????. 2,1
?.?.???????.???????? 1,1,1,4,6,1
??.??.#??##??#???? 1,11
????????##?#??? 12,1
?#??#?#.????#?#???# 6,9
?#???.#?.. 3,1
??#?.?#?????. 4,2,4
.??.?..??#??? 1,4
???#..??.?#??????? 1,1,1,4,3
?###???.?#???? 6,5
?.#?????????.?# 1,2,3,2,2
.?#?.#????##.?. 1,7
?.?#..???????? 1,1,2,2
?????.??#?.?#??..? 1,3,4,1
#??..??????????##? 1,1,1,1,3,5
?????.??#??##???? 2,1,6
..?.?#??###????. 2,4,1,1
##??.#????#?#???.. 4,6,2,1
??#?#??#.#???#??? 4,2,1,6
.#?#????#..?#??#. 8,4
???..???#?..#??? 2,5,1,1
?##?.?.???##?????.?# 2,1,1,7,1
??????#.?.?#???#.? 1,3,1,6
?????????#????#? 3,5,2
?.##?##???#? 5,3
???#?#??#?#?# 1,10
?##??#???? 3,1,3
??#??#????.??.?##. 1,3,2,1,2
???????##????? 1,5,1
??##????#.???# 9,3
?.??????#??.?.????. 9,2
??.??????#???? 7,2
??#?.??.#.??? 4,1,1,2
??.#??#??.?? 6,1
#??????????? 1,1,2,1
?##???##?.?##???? 8,5
?.?#?#??.?#??#?.? 3,4
.#?.????#??#?##.. 2,1,7
?#?.#?##.? 1,4,1
?????##?##??? 7,2,1
??.?.?##???? 2,7
???.????#???. 1,6
?#?????.??. 5,2
????#??.#?#. 1,2,1,1
.???.????#?#?.?? 3,6,2
???.??.?.?.? 1,1,1,1
?#.#????#??#??? 1,7,1
.???#?????#??.?? 1,2,2,1,1
..??.???##..? 1,5,1
.???????..? 2,2
?#????????????#? 2,2,4,1
????..??##?...#????? 1,1,4,1,1,2
?#.???#?????????? 2,4,4
?#??..??.#? 2,1,1
?.?#??????.??#?..?# 1,7,1,1,1
#??#..???? 2,1,1
??#?.??#?.???? 2,2,3
.#???..??? 1,2,1
.??.?#?##.#???.?#? 1,5,3,1
?????.?#?#??????#?? 1,1,7,1,1
??#??????.?#??#?#? 1,5,8
??.?.?.???????? 1,8
?#?#???#?????# 1,9,1
.??#.#??.?#???##?# 2,1,1,1,4
???#???.??#?#? 6,1,1
?###???.?#.?..? 4,2
?#???.????.??#.???. 5,2,1,1,1,1
??????..??.?.##.? 1,2
?.#?#??????...????? 9,1
..??.?.#?? 1,1,2
??##???????????.##? 9,1,1,2
.???.?????? 2,1,1
??#.#?.?#?????.?.? 1,1,1,1,3,1
???#????#????.#. 1,1,7,1
?????#?#?.?.. 6,1
???.???????#??#????. 1,12,1
??.??.?#??# 2,5
?.????#?#????. 1,4,1
???##????#??? 4,3
???????##. 1,1,3
.?.##???#?.?#????? 1,3,2,5
?.??.##??.? 1,2,2
???????#?#???? 3,1,7
#?#.??????#?#??.?.?. 3,2,8,1
.??.??.???? 1,2
???????..?#??? 4,1
?.????##?? 1,5
????#??#??.?#. 7,2
?.##????##?????#???? 2,5,5
.??#.???...##?? 1,1,1,1,2
#??????##???? 1,1,3,3
?###??????????????? 6,11
?#?.#????#??.? 3,2,2
.????#?????#?? 10,1
?????#???? 1,1,5
?#?????.?????#??#.. 1,1,1,1,1,4
????#??.?# 1,5,1
???#?????? 4,1,1
?#?..?.?.?? 2,1,1
#??.??#??#?##??#???? 1,4,1,5,3
?..?#?#??.#???? 4,1,2
?????#???#??#.?#??? 13,1,2
?..#??.??? 2,1,1
???#????#?.????#? 8,2
.???#.???##?????? 1,2,1,9
#..#?#???## 1,5,2
??..?#.??? 1,1,1
??????#?.??.???#. 1,3,1,4
.?##.?..???##?. 3,1,4
?#????#?#?????.? 9,4
??##?.?#??##??. 5,7
??#????####??..#???? 11,4
..#??????? 3,2
?.????????##????.?#? 11,1
.?##????#???. 4,1,4
#???.???????#. 2,1,1,5
#??????#??.?? 1,1,5,1
???????##???#?#.?#? 1,1,5,3,2
?##????##??##? 2,2,2,2
?##?#????..????#?? 5,3,7
.????.#???#? 1,1,2,1
??##???#.?.?#.#?? 7,1,1,3
??.#??#.?#?????.#? 1,1,1,6,1
???????.?#????? 3,1,5
??.?#?.?#?? 2,3
?##??????.?##?? 5,1,4
???.#???#?????#???. 2,12,1
???#??##???#??# 1,6,3,1
??.??.#??####??#?#? 1,2,2,10
??????.?.??????. 2,5
...???.??##?... 1,3
????#..#??#?#?#??### 1,1,13
????????.???.?#.? 4,1,2,1,1
??##??????#????? 7,4,1
???????#?#?#?????#.? 1,1,4,4,1
..?#???#????? 4,4
?#??.##???.#?? 2,5,1,1
.??????#??.#?.?. 1,1,3,2,1
#???.??????????? 1,1,1,9
??.??.?#?.? 1,1,3
#??????#??? 3,4
??#??.??.???#.??# 4,2,4,3
??#???????..?.???### 4,1,1,1,1,4
?.?????#??#?????.. 7,1
?????..?.# 1,2,1
.???###???????###??? 10,6
?#??.?????? 3,1
.#.??#??????? 1,2,1,1
.??#??????#? 1,8
?.?#??..?????? 4,4
?#?#.#.?.?#????? 4,1,1,1,4
?#.?.?###????? 1,1,6,1
.?#?##?###??.?..? 9,1,1
..??????#??????#??? 7,3,2
???#???#?????.. 7,1
??##????.??#??. 5,1
???#????.#?#????? 1,1,1,1,5
????#?????.? 1,5,1
?????#?????????#?..# 4,5,6,1
?????#?#???.?..???? 6,1,1,1,1
?.???#?#?.#?.?.? 1,5,1,1,1
?##????.?.?##?? 3,4
.#?..????. 2,1
??#.##??.. 1,3
?####?#####?????? 11,1
.??.#?..??#.???? 2,3,3
???..????#?#?. 1,3,3
????????#??? 1,2,4
##???.??.#?#????##?# 2,1,11
??.?##??.?..?#??. 3,3
??.#.#.??.????? 2,1,1,1,2
?????..?#???? 4,3
??????#?#??###??? 2,4,5
??#??#?#.?? 8,1
??#?????#? 6,1
??.##?#?#?#???# 8,1
#?#?##???#??#?#????? 1,5,2,1,1,1
.?.#?#?#..??. 5,2
??##?###????? 7,1
?.#???????##????? 1,1,4,2
.??.??.?.?#?????# 1,1,3,2,1
.#???????.??#?? 2,1,4
????##?????.#?? 8,1
????????.#.. 5,1
?????#?#???? 6,1
..?..???????..?#?# 6,3
??.?????#?#? 1,4,1,1
.?????#..???? 2,2,1,1
.#??????#???##??? 1,1,7,1
??.?##??#.????..? 5,1
?.??#.????? 1,1
???.?.?????#??#???# 1,1,1,1,8,1
.?#??.##.##??#??#??? 2,1,2,6,3
?.???#??????.? 4,1,2
?.?????#.?? 3,1
#???##?.?. 6,1
????.???##?#???????? 1,1,4,3,2
.??.?#?.## 2,1,2
???.??????????.?? 1,10,1
.???.?????? 1,1,2
??..???????#?..?#?#? 2,4,3,5
#?##?.????? 4,3,1
???#??#?#????#??#??? 7,7
??#.??##????. 2,4,1
??#??????????.#?? 1,6,1,1
????##?????.?#???? 7,1,4
?.??????????#.???? 9,2
???????##.????#.? 6,5
????#??.??????#???? 3,2,1,5
.???#?????#.?..???. 9,1
#..??.??##. 1,2,4
???????#?#..? 2,1,1,1
?????????.????? 2,5,1
???#?#???.? 1,6
?#???##?#?. 2,6
?..??#???? 1,1,1
?????#?.#.? 2,1,1
.#.????#??#?##?? 1,1,11
?.??.#??#????#. 1,1,1,6
?...##.????#.? 2,2
?????.???#??.#. 1,1,6,1
?#???#????###?#. 1,1,1,8
??#??.?.?. 2,1
#??????????.????##? 1,1,3,1,6
?.?.?????#??????#??? 1,1,9,1
???#??.????????##?## 1,4,4,1,5
.#???????. 3,2
???#.????.?.####?# 1,1,3,6
....??????#???? 3,6
.??????#??????.? 5,3
?.????.?## 2,2
?#????#?..?#? 7,1
.?#??????.??? 6,1
?.?#????????#??. 2,3
?..????#???.?#?? 3,1
##???#???.?.?.? 2,3,1,1,1
?.??#?.?#?#?####?.?. 2,9
.??..##?????. 1,3,3
.?#???##?#??.??..? 4,6,1
?.?#?..??#?#??. 3,6
???#?????##?.??#?#? 3,2,2,6
?#????#?.?#.#? 3,3,1,1
???#??????????????? 1,4,3,6
.##?#?.?#????##?? 2,2,7,1
?????#????.??.?.#??? 8,1,2,1,1,1
#.?.?????#?..????.? 1,1,7,2,1,1
..##?.#?.??#?.# 2,1,1,2,1
??#??...?#???##. 4,2,3
#?#?#????????????? 7,3,1,2
..#??#?##. 4,2
##?####.#??.??.?? 7,1,1,1,1
??#.???##??#.#?#? 2,8,4
?#????#..?.????#?# 2,3,2,4
?.?.#.?????#?#???. 1,1,1,2,1,6
?#???##?#.##???????. 8,6,2
????.??..??##?#? 1,2,1,5
???#??.#?#????? 1,1,1,1,5
????###?#?????? 1,12
???????##????#?##? 1,2,8,3
#.???.?.?#??????. 1,1,1,1,7
?.?#....????. 1,4
??.#???.?#? 1,2,1
?.?.?#???? 1,5
????#?.???#?? 5,1,3
??#?#??#.?.?? 8,1
??#.?#??#.??.?? 1,2,1,1,1
???#???..??#?? 1,1,3
??.#??????? 1,3
?.?#?#?#???????#? 1,8,1,3
?.?####??.?.?.? 5,1
?#???#?.???.?##? 2,3,1,2
.#??????#??..? 3,4
????##?.????#???#? 1,3,1,1,5
???????#????#????#?. 1,2,2,3,1,1
??#..?????#???? 1,2,3
????#?.??? 1,1
??.?#??#???.????? 1,5,2,2,1
..??????#.???# 5,1,1
?#?#?##.????. 6,2
?##.?????.??... 2,4
.????.#?...?##.# 1,1,2,3,1
.????#?#??# 2,7
?#?#.##??#?#??.?#??# 1,1,7,1,2,1
????#?????? 1,3
????##?#?..#?#?#??? 7,5
.?.???.??.?? 1,1,1,1
???.???#??.???#???# 3,4,3,3
.??##???#??#???#??.? 12,2,1
????#?#?#???#.#???.# 1,7,1,1,1,1
.?#?###??#??.?#?? 7,1,1,4
.#????.?#?#. 1,1,3
?#?????.?? 2,2
??.???#.?????? 1,2,1,3
?#.??##???#?.. 1,2,1,2
??.??.???#??? 2,4
???.????.?..?? 2,1,1,2
?#??#####???#.?????? 3,9,2
??.??.??#???#? 1,1,3,4
??#.?.??#???#??. 2,1,2,1,1
?.?????#?? 1,7
?.###????.??. 6,1
.??#??????#?##?? 8,1,4
???##?#???.??.? 6,1
.??..####? 1,4
??????.??????# 2,2,1,1
?.#???#.??#?? 5,3
?...#?#?.???#??.?# 1,1,1,3,1,1
#???.????? 1,1,2
??#..??#?? 3,3
#????.????#?#..?#. 2,1,1,5,1
.#?#??????????????? 1,1,7,1,1,1
??#?????#??.??.?## 11,1,3
#??#????#????? 9,1,1
?????##?????#? 2,8
???????????.???###? 9,1,3
??#?.?.???.#.?. 3,2,1,1
?.??#?#?????.???? 1,4,1,1,4
.##??????? 3,1,1
?????#???#????? 1,1,4,1
.??#?????..#????? 6,6
#??#??#????????# 13,1
??###?????#??????# 9,1,3,1
##???.???#?#?????# 2,2,1,5,1,1
.??...???#? 1,4
?.????.???.???#?#? 2,1,2,3,1
??#?#????? 1,1,2
???#??????????? 3,6
??#?.?#?#. 2,4
.?#????????.??? 3,4,2
????#.???????? 3,8
.??.???#?#???. 2,4
?.??#????#.#.??# 1,8,1,2
..???.?#??. 1,1,1
?????#..?#???# 6,2,1
?###???.#.???#?.??.? 6,1,2,2,1,1
?.??##??##???? 1,3,6
????#.??#??#??#??? 3,2,1,4
#?##?????.##????#? 5,2,7
????#??##?..??? 1,2,3,1
???????#????#?? 1,3,2,1
##??#???????..??#. 8,1,1,1
.##?#?##?#??#?#?#? 12,1,1
??????##?.????? 9,2
????????.. 3,1
?.?#??..?#???.# 1,1,1,5,1
.#???..?#.?#???? 1,1,1,2,2
#.#?#?#?#.#??.???? 1,7,2,1,1
????#??.?#?#??????#? 1,2,1,11
?.#???.??.?#????## 1,2,2,1,5
?#???.??.#?#? 4,2,1,2
????.?.????#??.?? 3,7
?????.#???.# 1,1,1,1
#?.?.???#?##??? 1,1,2,5,1
.?.??#.?#?..?#?????? 1,1,1,2,4,1
??????#.??????? 4,1,1,2
???##??###? 3,4
????.#?????#???#.# 2,2,1,1,1,1
?????.???#??#???? 4,7,2
#.??#?????#?. 1,5,3
?##????.??. 3,2,1
????..??##? 1,1,4
?.#??.?#??.??????#? 1,3,2,1,4
????.?#???. 2,2
#.???#?.?#?? 1,1,1,2
??##?.?#???##??.## 4,7,1,2
?.?????.?#? 2,1,2
????????### 2,6
#?.?????#?# 1,6,1
??#?#??.??????.??.. 3,1,1,4,1,1
?#?.??.#?? 1,2,2
.??????#.#??.#????# 7,1,3,2
??##???###?#??????? 5,8,2
?#.??#?????#??#?? 1,6,1,2,1
?.##??#?#???. 1,2,3,1
#???#????#?#????? 6,1,4,1
?.?#..?????????# 1,1,5,1
???#???.#??? 4,1,1,1
?#??#?##.??? 4,2,1
?####????#? 6,3
?????##??#?##??#???? 1,11,3
?????????????#??#??? 1,1,1,1,1,7
???????.??##.?#?? 3,1,3,3
???#?.????? 3,1
??.#??????#???.?#.? 1,1,1,5,2
?#???#??.. 1,1,3
??#?#???????? 5,1,1,1
?#.???#??#???#?#??? 2,3,9
????##?????.?#???# 1,2,1,2,6
?.????#???????.?? 1,8,1
.??????#?#?? 1,9
.?##..???#??.?# 2,1,1,1,2
.#?#?????#????????#. 1,1,1,2,7
??#??????#?#? 3,1,3
?????.???..???? 1,1,2,1,2
.???.???.#?#? 1,1,1
????#.??#?#?.?##??? 3,2,2,4,1
.????????.#?#??#? 1,1,1,4,1
?.#??##???????? 1,2,2,2,2
.?????#?????##? 3,1,2,2
???#??????.?? 1,3,3,1
.???#?####?#??.?# 1,11,2
#?#..????#?. 1,1,1,2
.???????#??#??? 3,5
?.?.???#?.?#??. 1,1,1,3,3
?.??#?#####?.#???.? 8,4
??.???#?.#??#????#?# 5,5,3
.??????..??? 1,1,3
#????##??????? 3,3,2,1
#?.?##??##????. 1,9
??#??#.????#?.?#?## 3,1,2,3,5
.???#?????.?? 3,1
..????????#???.. 8,1
?????#?.???# 4,2
?.?.????#??.???##? 1,1,2,1,1,4
??#?#..?#???#?#??.?? 4,8,1
?#??.??.?#? 3,1,2
?.?...##???? 1,5
??#?.??????? 2,5
???.??##?#?#??? 1,1,7,1
.??.???????#???? 1,9
??##?.????.?#???#?? 5,3,1,4
#?????#?.?? 2,3,2
??#??#???##??????.? 4,11
???????##????. 1,11
?#??..?#??#??? 2,6
????????#?#????#???? 1,1,8,1,1,1
?..?.#??.???#?? 1,2,2,1
???#?.???#? 4,2
?.??.#?.??? 1,2
???.?????#? 2,3,1
?..#??#???#?#.? 1,1,1,5
?#?#?#??????#.?#???? 13,3
????#?.??????? 2,6
???..#???.????#? 2,4,4
?????#.??#?#??#?##? 1,1,1,6,3
.???????????? 2,5
.??.??.?????.??#?#? 2,1,1,2,3
.?#?#??????.###?#.? 5,2,1,5,1
??.??##???#?.?.????. 7,1
.#??.?#???#?#?????.. 3,12
?..??..#?.?.?? 2,2
???????.?#????. 1,5,2,1
##?.?#.???????#??#? 3,1,1,2,2,1
?.??#?.?????????. 4,1,1,1,2
????.??##? 3,4
?..??.?#???#?#???#.? 1,11
???#??#?????????. 1,4,4,1
#????#?.??#. 1,3,1,1
.???..??????.? 2,1,2
.??????????#?##?.?? 1,7
#.?.#.????#?.#? 1,1,4,2
???#?.?.??#. 4,1,1
?.??#??.?.?.#????# 3,1,1,1,4
??????#?#.?# 2,4,1,1
?.?????##?.??.??? 1,1,4,1,1
?##????.?.#?# 5,1,1,1
..??#??#??. 1,3
??????#?#???..??. 9,1,1
?.#.#?##?##?#???# 1,1,1,7,1
??.?#????? 1,1,4
?.?.??#?#.??#????. 1,5,5,1
???.?#?#??? 1,1,1
??#??????? 1,2,2
..????.??#.? 1,3
???.??..??#?##??.?.? 2,7,1
?#?.???.????.?? 1,3,1,2
#?????#.???# 5,1,1,1
??.??.???#???##??? 2,7
?.?.#?#??.???..? 1,1,3,1,1
.#?.???..###??????#? 2,1,5,5
??.??????????.???? 8,2
??????????? 4,1
??#??#???.#. 3,2,1,1
???#????##?.?#?#? 4,4,4
??#????#?????.. 2,8
?.???.##?????? 1,1,6
??#.?##???#?. 2,2,4
???#?#?????????? 6,1,2
?.????##?###?##? 9,3
?????????? 1,4,1
.??#?????? 4,1
.??##..?#?#? 2,4
?????#??#??#?.#.? 1,8,1
.??.?##?#?#? 1,7
????????#??. 2,6
??#.?.#???.?? 2,4
?##?##???##? 7,3
?#????????#? 3,3,2
?.?????##?? 1,4
.????????.??? 5,3
##.????#??? 2,3,1
?#?.?..??. 3,1,2
????????#????##??### 1,3,3,9
??????#????#????? 2,4,1,6
???.???.#.???#?##? 2,1,1,1,5
???###?.#?????##.. 6,8
???#???#?##.??#?. 3,6,1
?#???...?.??###.??.# 4,1,4,1,1
??????#??#? 1,2,2
??????.??.??. 1,2,2,1
?.?.#????? 1,1,1
.??????.#??? 1,1,1,1
?.?#??#??.????#??.?# 2,2,1,3,3,2
??????.?.#?#???.? 4,1,1,2,1
?????#.###.? 1,2,3,1
???##??#??#???????? 12,4
?#?????????? 3,1,1
?.??#??.????#? 5,1,3
.???##???? 1,2,1
?.???????? 4,1
.#?.?.???? 1,3
??#.??????# 3,3,1
??.?##?.?.??#?? 1,2,1,1,2
.????#??.##??.?#. 2,4,2,1,1
?????.#??. 2,1,1
?#?????#.? 2,1,3
?.?????#?? 1,5
??????#?#..?? 1,1,1,2
?????.????###? 1,2,1,5
.???#?#??? 4,1
.?.?###????? 1,5,1
??????????..?###? 6,1,3
????#?#?#?????###??? 2,3,3,8
??#?..#???? 1,3
???#???.??.?? 4,1,1
??#..???#???#??? 1,1,5,4
??..???##?.??#..? 1,4,1,1,1
#??#.?#????? 1,1,4,1
.??.?##????# 4,2
??#??#????.???# 1,1,1,1,2
?#.????.?.????#??.?# 2,3,1,2,3,1
##???..?.?.????? 5,1,2,1
???.?????????????#?? 1,15
??##???.??#??? 1,5,2,1
.?.??????#?? 2,3
?.#???#??? 1,2
.??.??..???# 2,2,2,1
????#?#??? 1,4
??#??#???? 1,3
??#..??#??????? 1,1,1,8
??????.????#???#.? 1,2,1,6,1
.???##???? 1,2,1
.?????.?#..?. 4,1
#?.???####?#?.???? 1,1,8,1,2
.?.?#..??#??.? 1,3
?????#????????#??. 1,6
#???#??.??# 1,3,3
?????????? 7,1
??.???.??? 1,1,1
??????#??.???????.#? 1,2,1,5,1,1
?#??????????????#?. 5,2,7
#???.?.??.?..#? 3,1,1,1,1
.????????????.???.# 1,9,1,1,1
?#?#??????#???## 6,7
..??#.???#.#.????#? 3,3,1,5
?????###?????##???. 16,1
????????#??????#??# 1,1,7,5
.#?????#???####??#? 2,4,8
?#.????###?#?. 1,1,1,6
?.??????###??#?? 1,1,6,4
.?..??.??.???#?.##? 1,1,1,5,3
?????.?#??#??##? 1,2,1,1,3
?#??.?.#?? 3,3
.?????#??.?.# 1,5,1,1
.???????.??#?##?#?#? 1,5,1,9
????#?#??#. 5,1,1
?#????.##?##?..?# 5,6,2
.?????.??#????#???# 1,3,5,2,1
?##????.#??????#? 6,1,1,1
??##?.????##??#?#?? 5,4,4
.???###??...?????? 1,4,1,1,1,2
???#?..???. 3,2
.?.?.#???##???.. 1,2,6
????#?#?#?????. 10,1
.???#??.??.??? 2,1,2
?..#?.?#?????.?? 1,2,1,3,1
??????.??#?#?#. 1,1,3,3
??#??.?##?????##??? 2,3,4
?#?.#.???? 2,1,1
.?.?#?#?####.?.#?# 1,3,4,1,1,1
??.#?..?#?????? 1,1,3,1
#??#??#??.?# 2,6,1
?#??#???????#??#??? 5,6,2
?..#??#?#####.?#???? 1,10,1,1,1
??.????#???#?##?? 1,9
????.?#.?# 1,1,1
???????????? 6,1,2
#..????#?#?#??##.??. 1,3,1,1,5,2
??#?.????###???? 1,1,1,6,1
????.????#?.?# 2,1,1,1
???##????.?.???.??. 1,2,2,2,2
?????.#?#.???.??? 2,1,1,1,2
???#??????.?? 4,1,2
?#?#?????#?#..??#. 11,2
.?#?##?????###???.#? 6,7,1
#?.##?????# 1,8
#..#????????? 1,3,1,2
????#??#??? 2,2
.?##?.?..?.???.?# 4,1,1,1,1
?.????.?#?.???? 2,1,2,2
??#??#?.?. 6,1
?#??#??#??##..?## 3,1,6,3
??#.???##? 2,4
#??#????.?????..?.? 1,5,2,1,1
.?#??#??#????#?#?? 2,2,10
####????#??##.?????? 5,1,3,4
???##.?.??.? 1,2,1,1
.?#?????##?????##?. 8,4
.?#????###??#??#???? 2,11
???###?#???#????# 9,1,4
??.??.?.?#???. 1,1,4
#???#??#?#?#???##? 1,3,1,1,1,2
#????##?.? 1,6
##?.?#?#??#?? 3,7
??##????#?.?.?#?#??? 1,2,5,1,1,4
.?#?#?..#?.... 4,1
##?#?#??????. 2,4,1,1
?????????#?????? 1,3,1
?.??#??????? 3,1
###?????#?#??#.#??. 3,2,4,1,1,1
.#???.??###? 1,1,5
?###???.?????. 5,2
?##???????????.? 3,1,5
??#??#?####??.?? 9,1,1
##??#..??????.??#??? 3,1,1,4,2
.???.???...?????? 1,1,5
.?????#????# 3,2,2
.####?.???? 4,1,1
?#.?#??#??##?????? 2,12
.????#?.???? 2,1,2
??#????#??#?? 3,5
?????#???#.?..??#??# 9,2,2
??????.?#? 1,1,3
?#?.#?????. 2,1,1
?#??.???.? 2,1
???????#?.. 6,2
#?????#?#??..# 10,1
?????????. 1,2
...??.##?????#??.?? 8,1
#??????#??##???.? 2,4,6,1
?.##????#??#.?#???# 3,1,1,2,2,1
???#??.???? 1,2,1
#..??#??#??.?????.? 1,4,2,3,1
?#?#.??###??##? 4,9
.???#.??.? 4,2
?..?.?#.????#.?? 2,2
.???##??#???###.?.?? 6,7,1
??##???#?.?? 4,1
??##?#????#?????#.? 13,1
???#?.#?##?.#?#? 3,5,1,1
??.???#????. 1,5,1
.??#???.???. 5,2
??????.#??#.??? 5,4
??#????#?##???.?#??? 12,3
#????????? 1,1,2
???????????#?.. 1,1,1,1,2
??#??#?##????#???#?? 1,2,9,2
?????..??????.??#.?. 3,3,3
??.?#?#?????##?.#?.? 4,6,1,1
??#????##.???? 8,2
?#?.??.#?#?##????? 2,1,9,1
???#???#?..??.?.. 7,2
#.??#??#???.????.?#? 1,9,1,1,2
????##?.?.??.?????## 7,1,2,1,1,2
.?#?#???#???#.?.. 6,1,1,1,1
??.?#??#????.? 1,3,5,1
?#?.??#??? 2,3,1
???#?##???????? 6,1,1
?#?.?????#?????#?. 2,5,5
#?#?#??#???.???? 6,1,1,2
?.??#????#?.??###?. 8,5
.##??#??#???.? 2,2,1,1
???##?.??? 1,3,1
?##.?.????#.#..?# 2,1,3,1,1
?#?#?...?#?#????.??? 4,3,2,3
..##??..????#?????? 2,9
?#??.?#?#?????#???. 3,5,4
???#?????.#???#??? 1,1,1,1,5,2
????.??.#?#??# 2,1,3,1
?#??#????#???.#? 12,1
??????????#??????.?# 1,7,1,2,2
??.????#?##????#? 1,2,1,4,2
??###????? 1,3,1
?#?#???#???.??# 3,1,1,1,2
???#????????. 6,1
##..????.? 2,3
?##????... 3,3
.?.?.?.#?? 1,3
.?.???????????????? 8,7
??#?###?.??..?? 7,1,1
?????.?#?#? 2,3
??#.??#???????#????. 1,7,1,3,1
?????.??#?? 1,1,4
.?????##??# 3,4,1
..??.??#??. 1,1
??????????.#??#?#? 6,7
##???????? 4,4
?????##.?#??. 5,2
#?.?????#??? 2,2,1,1
??#??...??? 4,1
???#??.???#? 1,2,4
??#?????.#? 1,5,1
????.??##?? 2,1,3
?????.??.?.? 3,2,1
.#??.???.?.??#??#?? 2,2,1,2,1,1
#????.??..??#?.#?## 5,1,1,2,4
???????##.????.?#? 7,1,2,2
.???.???????#??????? 1,2,1,5,2
.?#????.??? 1,1,2
.#?#?#?#??#???#..??? 1,10,1,1
??.????#?.????????#? 1,3,2,1,8
?????##??#??.????.. 5,2
..?#???#?##?#??? 2,2,5
??#.?#.??????#? 2,2,1,1,2
.???.????#????? 1,8
??##?###??????#???? 8,3,2,2
???..#.??#? 2,1,2
?#???#???.?# 7,1,1
.#?.???#???#? 1,7
???.??#???..??.? 3,2
..?.#????????. 1,1,1,3
????#??#???#??????? 9,1
.?#????.?...?. 5,1
#??.?????.???#??#?? 3,4,5,1,1
????###??#? 5,1
#???##?#??.?.?????? 10,1,2
?????#?##??.?...##?? 1,6,4
???????#???.?##??. 4,4
#.??#?#.#??.??# 1,2,1,2,3
?????.??????? 2,1,1,1
?????#.##??#?#? 1,3,7
.??????#?#???.??.?. 12,2
??#????.####??#??.?? 3,1,4,3,1
?#.#?????#.?#? 1,7,2
?.?????.?????? 3,4
??????#?.????#???? 2,1,1,1,6
???.#???#? 1,1,2
????#???#??. 6,3
#?##????.?? 6,1,1
?.???##?##.??? 7,1
????.????#.? 2,5
.?#???#???# 1,3,3
##????..#??###???.?? 6,2,4,1,1
?????#?..?#???#?? 2,2,8
??#?##??..?#????#??? 5,3,2,2
???#?????#?.???? 1,7,2
.?.???#????.??#???? 5,1,1,1,2
#????????#?.?#?? 11,1
???#??#??? 1,5
?#??#??????#? 2,1,4
????.#??#.??? 1,1,1
.?????????? 7,1
.??#?#???.??. 1,5,1
#???#?????.#..?..? 1,1,6,1,1,1
?..??.???#???? 2,5,1
???????..??##???.. 3,7
#????.????? 5,1,2
.??#????#???? 1,3
?##????##?. 3,1,3
.?..??#??? 2,1
??#?#????.?# 4,3,1
?##?..????#??#??#? 2,6,1,2
??#??#?###???##?#.#? 1,1,12,1
??##??.#?#??#?.? 1,4,7
??##?#??#??? 6,2,1
????.???.?#?#?##? 2,2,6
#????.????.# 4,1,1,1
#?????#?.???? 1,1,1,3
?#???.##?##?#?#?.?# 3,2,2,4,2
..#?#??#?????#?? 4,9
??#?.??#?. 3,3
.??.????????# 1,2,1,2
?.????..?????????? 1,2,6,1
??#??.????#??.????#? 5,3,3,1,2
.#?.????.????#?? 2,1,2,5
#?.##????#? 2,3,2
..#?.#?##???.?#?#? 2,4,1,4
????????????#??.?#? 4,1,5,1,1
#?#????#..#????##??? 1,1,2,1,6
?#???#?#?????? 2,8,1
?#???.?#?? 2,1,4
?#???.???#?# 1,2,6
?#?##?.??# 5,2
?#???.???????? 3,1,7
?.???????????#?????? 1,3,1,4,1,2
..???????.??? 1,1
#?????#??#.?.#.??..? 10,1,1,2,1
?.?#??????? 4,2
.???#????##?????? 10,2
?#??????##. 1,1,2
###???????#..??#.?? 11,3,1
.???#??.?#??? 2,1,2
.?.?###?##? 1,3,2
#.#?#??####?#?????. 1,1,10,1
.??.????#?#? 1,5
#???????#.??? 3,1,1,1
#..????#??#?#?##. 1,13
?.???.?#?.???#.???? 1,2,2,2,1,3
?..????????. 1,2,3
?.????.?....#????? 2,1,1,6
?##?..??#. 3,3
???.#???..??#.. 2,1,1,3
.?#??.????? 2,1
??????.???. 1,1,1
???#.????#???????. 1,1,8,1
???##???.??#??? 3,1,1,2
????#?..??? 1,2
???#.#??#???##?.??? 1,1,1,7,1
?.????#.?????? 1,5,3,1
????????.??#??#.??.? 1,6,3,1,1,1
..???.?..?#?? 2,1,1,1
???.??..????###?#? 1,1,1,7
??.????.????###? 2,6
????#??#?.?# 1,4,2
.#.##?.?????. 1,2,2
?.????????? 2,2,1
?#???#???.??? 2,1,2,2
???????##? 1,6
#.?????#.#????# 1,4,6
??.##?#?????.#?????? 2,9,1,2,1
##.?..?####?##?? 2,8
???#?.???#??#????? 3,10
?#?????????.?#?????? 10,4,2
.???.????#????? 1,3
#??.?????? 3,2
.??????.?#?#?? 1,1,6
?????????#.# 1,1,1,1
??#.?#???????#.????? 2,6,2,5
??.?#?##??#?#?##??? 13,1
.?.?#???##? 1,1,3
#??????.##. 1,2,2
?##??#????? 6,1
?#????#??#.??.# 6,1,1,1
##...???.?. 2,1
?###???#.#?#?..?.?? 8,3,1
??#?.???##???????#. 1,1,1,4,1,1
#####?.????#???# 5,1,1,3
#???###??..?#? 2,6,2
?.???#??.#?? 4,1,2
????#?#?????????# 1,9,1,1
?##??????#? 3,2,2
"""
]


if __name__ == "__main__":
    main()
